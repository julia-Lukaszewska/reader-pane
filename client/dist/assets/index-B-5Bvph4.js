import{m as p,n as f,u as g,a as i,o as B,r as u,p as d,q as l,t as O,v as P,w as S,x as k,j as c,R as x,O as I,d as R}from"./index-8dlqaOPT.js";function h(){console.log("[useLastOpenedBook]");const{bookId:e}=p(),a=f(),s=g(),t=i(r=>r.book.lastOpenedBookId),[o]=B(),n=e??t;u.useEffect(()=>{if(e){s(d(e)),s(l(e));return}t?(s(d(t)),a(`/read/${t}`,{replace:!0})):a("/",{replace:!0})},[e,t,s,a]),u.useEffect(()=>{n&&(s(l(n)),o(n).unwrap().catch(r=>console.error("Failed to update lastOpenedAt",r)))},[n,s,o])}function v(e){console.log("[useStartingPage] bookId",e);const a=g(),s=i(o=>O(o,e)),{data:t}=P(e,{skip:!e||s!==1});u.useEffect(()=>{!e||!t||s!==1||(console.log("[useStartingPage] setting start page to",t.currentPage),a(S({id:e,stats:{currentPage:t.currentPage}})))},[e,s,t,a])}function m(){console.log("[useInitReaderSession] mounted"),h(),console.log("[useInitReaderSession] called useLastOpenedBook()");const e=i(k);console.log("[useInitReaderSession] activeBookId:",e),v(e),console.log("[useInitReaderSession] called useStartingPage() with:",e)}const L=R.div`
  display: flex;
  flex-direction: column;
  height: 100%;
`,E=()=>(m(),c.jsxs(L,{children:[c.jsx(x,{}),c.jsx(I,{})]}));export{E as default};
