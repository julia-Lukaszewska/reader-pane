import{m as g,n as f,u as p,a as c,o as m,r as i,p as d,q as l,t as R,v as x,w as y,x as B,j as u,R as L,O as v,d as O}from"./index-CbYdQxyi.js";function P(){console.log("[useLastOpenedBook]");const{bookId:e}=g(),a=f(),t=p(),s=c(r=>r.book.lastOpenedBookId),[o]=m(),n=e??s;i.useEffect(()=>{if(e){t(d(e)),t(l(e));return}s?(t(d(s)),a(`/read/${s}`,{replace:!0})):a("/",{replace:!0})},[e,s,t,a]),i.useEffect(()=>{n&&(t(l(n)),o(n).unwrap().catch(r=>console.error("Failed to update lastOpenedAt",r)))},[n,t,o])}function S(e){console.log("[useStartingPage] bookId",e);const a=p(),t=c(o=>R(o,e)),{data:s}=x(e,{skip:!e||t!==1});i.useEffect(()=>{!e||!s||t!==1||(console.log("[useStartingPage] setting start page to",s.currentPage),a(y({id:e,stats:{currentPage:s.currentPage}})))},[e,t,s,a])}function k(){console.log("[useInitReaderSession] mounted"),P(),console.log("[useInitReaderSession] called useLastOpenedBook()");const e=c(B);console.log("[useInitReaderSession] activeBookId:",e),S(e),console.log("[useInitReaderSession] called useStartingPage() with:",e)}const I=O.div`
  display: flex;
  flex-direction: column;
  height: 100%;
`,h=()=>(k(),u.jsxDEV(I,{children:[u.jsxDEV(L,{},void 0,!1,{fileName:"C:/Reader-App/client/src/layout/ReaderLayout/ReaderLayout.jsx",lineNumber:37,columnNumber:7},void 0),u.jsxDEV(v,{},void 0,!1,{fileName:"C:/Reader-App/client/src/layout/ReaderLayout/ReaderLayout.jsx",lineNumber:38,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Reader-App/client/src/layout/ReaderLayout/ReaderLayout.jsx",lineNumber:36,columnNumber:5},void 0));export{h as default};
